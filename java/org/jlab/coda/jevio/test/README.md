
# Java Evio Test Program Guide

---------------------------

    Short, minimal guide to test programs that were collected over the years and left as is.
    
    NO GUARANTEES as to functionality or effectiveness, just dig in and parse it yourself.
    One possible source of things not working is that most of these programs were written
    for evio version 4 and may not translate well if assumptions about the format are built in.

---------------------------
| Checked | Mirrored C++ file                                                                                     | File                                                                 | Function                                                                                                                                                                                                                                                                                                                                                                                        |
|---------|-------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| x       |                                                                                                       | [BigFileWrite.java](BigFileWrite.java)                               | Write 2GB file in 15kB chunks with either RandomAccessFile, FileOutputStream (channels), or evio data with EventWriter and print out data rates.                                                                                                                                                                                                                                                |
| x       | [CompactReaderAddSubtractTest.cpp](../../../../../../src/test/CompactReaderAddSubtractTest.cpp)       | [CompactReaderAddSubtractTest.java](CompactReaderBugTest.java)       | Create and write events to buffer. Have EvioCompactReader scan buf, get EvioNodes, check them for status and print them out. Use reader.addStructure and removeStructure to change buf and then printout.                                                                                            |
|         |                                                                                                       | [CompactReaderBugTest.java](CompactReaderBugTest.java)               | Write file with FileChannel from hand-set evio 4 int data, turn into byte data, read with EvioCompactReader, get and print data. Or explore ByteBuffer capabilities.                                                                                                                                                                                                                            |
|         |                                                                                                       | [CompactReaderTest.java](CompactReaderTest.java)                     | Methods to create events and evio data in various forms. Method to change data endian and compare. Methods to write events to buf or file in various ways with EventWriter and EventCompactWriter. Methods to read using EvioCompactReader including with EvioCompactStructureHandler. Compare searching with EventReader & StructureFinder versus EvioCompactReader.                           |
| x       | [EvioCompStructHandlerTest.cpp](../../../../../../src/test/EvioCompStructHandlerTest.cpp)             | [CompactStructureHandlerTest.java](CompactStructureHandlerTest.java) | Create evio event buffer, put into EvioCompactStructureHandler, remove node, and examine resulting buffer.                                                                                                                                                                                                                                                                                      |
|         |                                                                                                       | [CompositeDebugger.java](CompositeDebugger.java)                     | Find CompositeData banks in file, print out data even if error in format.                                                                                                                                                                                                                                                                                                                       |
|         |                                                                                                       | [CompositeTester.java](CompositeTester.java)                         | Create buf with CompositeData by hand, check double swapped with original. Or using strings with CompositeData. Or using CompositeData.Data class to create EvioEvent, write to file, read back. Or print out XML form of each event in file. Method to print CompositeData object.                                                                                                             |
|         |                                                                                                       | [CompressionTest.java](CompressionTest.java)                         | Comments on different compression formats gathered from various sources. Many methods to compress & decompress data with zlib/gzip in different ways. Write compressed files and decompress while reading. All studies used to help in implementing compression handling. **NOT** useful for users.                                                                                             |
|         |                                                                                                       | [CompressionTest2.java](CompressionTest2.java)                       | Compress data with LZ4, uncompress, compare result to original data.                                                                                                                                                                                                                                                                                                                            |
|         |                                                                                                       | [DictionaryTest.java](DictionaryTest.java)                           | Write out dictionary with file and read back in.                                                                                                                                                                                                                                                                                                                                                |
| x       | [DictTest.cpp](../../../../../../src/test/DictTest.cpp)                                               | [DictTest.java](DictTest.java)                                       | Many tests of dictionary use. Define different dictionaries. Methods to play with EvioXMLDictionary and EvioDictionaryEntry methods. Methods use dictionary with EvioEvent, EvioBank, and EvioSegment.                                                                                                                                                                                          |
|         |                                                                                                       | [ExtractHallDdata.java](ExtractHallDdata.java)                       | Used only for HallD data compression test for ESNET. Take HallD data file, pull out data (not headers) and store in files to test for compressibility.                                                                                                                                                                                                                                          |
|         |                                                                                                       | [FileTest.java](FileTest.java)                                       | Methods to test how the AsynchronousFileChannel affect its ByteBuffer arg when reading and writing, find free space on disk, writing event too large for record space, read/write/append data in files, use listeners and filters, write file with extra words in headers.                                                                                                                      |
|         |                                                                                                       | [FileTestVer6.java](FileTestVer6.java)                               | Create event in buffer of CODA Prestart, Go, write and read evio v6 data files.                                                                                                                                                                                                                                           |
|         |                                                                                                       | [FileWritingSpeedTest.java](FileWritingSpeedTest.java)               | Test speed of writing evio file to disk.                                                                                                                                                                                                                                                                                                                                                        |
| x       | [FileWriteTest.cpp](../../../../../../src/test/FileWriteTest.cpp)                                     | [FileWriteTest.java](FileWriteTest.java)                             | Compare writing same events as ByteBuffers to file with EventWriterV4 (evio 4) and EventWriter (evio 6).                                                                                                                                                                                                                                                                                        |
|         |                                                                                                       | [FirstEventTest.java](FirstEventTest.java)                           | Write file or buf with dictionary and first event. Or write first event after EventWriter created.                                                                                                                                                                                                                                                                                              |
| x       | [Hipo_Test.cpp](../../../../../../src/test/Hipo_Test.cpp)                                             | [HipoTest.java](HipoTest.java)                                       | Create events with CompactEventBuilder, write into hipo file with Writer or WriterMT and read back with Reader, printout. Also create events with createTreeEvent, write with EventWriter, read with EvioReader, printout. Also run similar tests on buffers.                                                                                                                                   |
|         |                                                                                                       | [ReadAggOutput.java](ReadAggOutput.java)                             | Read and parse CODA data file produced in streaming mode with Aggregator.                                                                                                                                                                                                                                                                                                                       |
|         |                                                                                                       | [ReaderTest.java](ReaderTest.java)                                   | Use a few files produced by SwapTest. Methods to read XML string and convert to EvioEvent, read evio file and create xml rep out of event and convert back to EvioEvent, get EvioNode with CompactEventReader and convert to XML, read with EvioReader and convert EvioEvent to XML.                                                                                                            |
|         |                                                                                                       | [ReadSequenceTest.java](ReadSequenceTest.java)                       | Write file, read events back with EvioReader.parseNextEvent() with sequential API call.                                                                                                                                                                                                                                                                                                         |
| x       | [ReadWriteTest.cpp](../../../../../../src/test/ReadWriteTest.cpp)                                     | [ReadWriteTest.java](ReadWriteTest.java)                             | Write 1 event with Writer class and a user-header specified in constructor into buffer.  Read back with Reader, EvioCompactReader and EvioReader and compare to original buffer.                                                                                                                                                                                                                |
| x       | [ReadWriteV4Test.cpp](../../../../../../src/test/ReadWriteV4Test.cpp)                                 | [ReadWriteV4Test.java](ReadWriteV4Test.java)                         | Writes evio v4 file with EventWriterV4 with set endian, first event and dictionary, reads back. Routine to write evio v4 buffer. Reads back with EvioCompactReader and EvioReader.                                                                                                                                                                                                              |
| x       | [RecordSupplyTest.cpp](../../../../../../src/test/RecordSupplyTest.cpp)                               | [RecordSupplyTest.java](RecordSupplyTest.java)                       | Test of RecordSupply class (based on Disruptor-cpp) with one thread getting & writing into record, multiple threads compressing records, and a thread to get and write out final record. RecordSupply is **NOT** meant to be used directly, but is used in WriterMT to do multithreaded compression.                                                                                            |
|         |                                                                                                       | [SequentialReaderTest.java](SequentialReaderTest.java)               | Test what happens when reading events from file and calling random access methods first followed by sequential methods.                                                                                                                                                                                                                                                                         |
|         |                                                                                                       | [SplitTest.java](SplitTest.java)                                     | Test automatic file naming routines or cause file splitting when writing data by setting small file max size so user can look at file names.                                                                                                                                                                                                                                                    |
|         |                                                                                                       | [StructureBufferDebugger.java](StructureBufferDebugger.java)         | Read file, pick event #. For internal event structures containing int or long data with given tag & num, use EvioNode.getStructureBuffer(). Compare copy of data given by getStructureBuffer() to original data of EvioNode. Compare data in both array and ByteBuffer forms.                                                                                                                   |
|         |                                                                                                       | [SwapTest.java](SwapTest.java)                                       | Create EvioEvent with all kinds of data, double swap event and time it. Or write file with such an event. Or write event to 1 file and its swapped version to another file. Or finally, take event written to buffer, double swap it and compare data with original.                                                                                                                            |
|         |                                                                                                       | [Tester.java](Tester.java)                                           | Lots of little routines/tests: printing ByteBuffers, parsing hex string, print long as hex, adding banks to banks, byte shifting, test EvioEvent.clone(), ByteBuffer handling of endianness, different ways of writing ByteBuffer of doubles/ints into another ByteBuffer, handling of shorts and padding, writing and reading of string data, find best way to convert byte array to int array. |
| x       | [Tree_Buf_Composite_Builder_Test.cpp](../../../../../../src/test/Tree_Buf_Composite_Builder_Test.cpp) | [TreeBufTest.java](TreeBufTest.java)                                 | Test BaseStructure's tree methods and finding structures thru filters and listeners.                                                                                                                                                                                                                                                                                                            |
|         |                                                                                                       | [UnpackStringTest.java](UnpackStringTest.java)                       | Test method to unpack a byte array into string data. Also how a bank of strings is processed by the EvioReader when data len = 0 or len = 1.                                                                                                                                                                                                                                                    |
|         |                                                                                                       | [Writer_Reader_Test.java](Writer_Reader_Test.java)                   | UseCompactEventBuilder to create event, write into buffer with EventWriter and read out of buffer with EvioCompactReader.                                                                                                                                                                                                                                                                       |
