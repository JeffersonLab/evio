<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- GitHub action javadoc-cleanup -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- End javadoc-cleanup block -->
<!-- Generated by javadoc (1.8.0_432) -->
<title>WriterMT</title>
<meta name="date" content="2024-12-17">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="WriterMT";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/WriterMT.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/jlab/coda/hipo/Writer.html" title="class in org.jlab.coda.hipo"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/jlab/coda/hipo/WriterMT.html" target="_top">Frames</a></li>
<li><a href="WriterMT.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.jlab.coda.hipo</div>
<h2 title="Class WriterMT" class="title">Class WriterMT</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.jlab.coda.hipo.WriterMT</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd>java.lang.AutoCloseable</dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">WriterMT</span>
extends java.lang.Object
implements java.lang.AutoCloseable</pre>
<div class="block">This class is for writing Evio/HIPO files only (not buffers)
 while multithreading the compression of data.<p>

 At the center of how this class works is an ultra-fast ring buffer containing
 a store of empty records. As the user calls one of the <a href="../../../../org/jlab/coda/hipo/WriterMT.html#addEvent-byte:A-int-int-"><code>addEvent(byte[], int, int)</code></a> methods,
 it gradually fills one of those empty records with data. When the record is full,
 it's put back into the ring to wait for one of the compression thread to grab it and compress it.
 After compression, it's again placed back into the ring and waits for a final thread to
 write it to file. After being written, the record is freed up for reuse.
 This entire ring functionality is encapsulated in 2 classes,
 <a href="../../../../org/jlab/coda/hipo/RecordSupply.html" title="class in org.jlab.coda.hipo"><code>RecordSupply</code></a> and <a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo"><code>RecordRingItem</code></a>.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>6.0 8/10/17</dd>
<dt><span class="simpleTagLabel">Version:</span></dt>
<dd>6.0</dd>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>gavalian, timmer</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#WriterMT--">WriterMT</a></span>()</code>
<div class="block">Default constructor is single-threaded, no compression.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#WriterMT-java.nio.ByteOrder-int-int-org.jlab.coda.hipo.CompressionType-int-int-">WriterMT</a></span>(java.nio.ByteOrder&nbsp;order,
        int&nbsp;maxEventCount,
        int&nbsp;maxBufferSize,
        <a href="../../../../org/jlab/coda/hipo/CompressionType.html" title="enum in org.jlab.coda.hipo">CompressionType</a>&nbsp;compressionType,
        int&nbsp;compressionThreads,
        int&nbsp;ringSize)</code>
<div class="block">Constructor with byte order.</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#WriterMT-org.jlab.coda.hipo.HeaderType-java.nio.ByteOrder-int-int-java.lang.String-byte:A-int-org.jlab.coda.hipo.CompressionType-int-boolean-int-">WriterMT</a></span>(<a href="../../../../org/jlab/coda/hipo/HeaderType.html" title="enum in org.jlab.coda.hipo">HeaderType</a>&nbsp;hType,
        java.nio.ByteOrder&nbsp;order,
        int&nbsp;maxEventCount,
        int&nbsp;maxBufferSize,
        java.lang.String&nbsp;dictionary,
        byte[]&nbsp;firstEvent,
        int&nbsp;firstEventLen,
        <a href="../../../../org/jlab/coda/hipo/CompressionType.html" title="enum in org.jlab.coda.hipo">CompressionType</a>&nbsp;compType,
        int&nbsp;compressionThreads,
        boolean&nbsp;addTrailerIndex,
        int&nbsp;ringSize)</code>
<div class="block">Constructor with byte order.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#WriterMT-java.lang.String-">WriterMT</a></span>(java.lang.String&nbsp;filename)</code>
<div class="block">Constructor with filename.</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#WriterMT-java.lang.String-java.nio.ByteOrder-int-int-org.jlab.coda.hipo.CompressionType-int-int-">WriterMT</a></span>(java.lang.String&nbsp;filename,
        java.nio.ByteOrder&nbsp;order,
        int&nbsp;maxEventCount,
        int&nbsp;maxBufferSize,
        <a href="../../../../org/jlab/coda/hipo/CompressionType.html" title="enum in org.jlab.coda.hipo">CompressionType</a>&nbsp;compressionType,
        int&nbsp;compressionThreads,
        int&nbsp;ringSize)</code>
<div class="block">Constructor with filename and byte order.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#addEvent-byte:A-">addEvent</a></span>(byte[]&nbsp;buffer)</code>
<div class="block">Add a byte array to the current internal record.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#addEvent-byte:A-int-int-">addEvent</a></span>(byte[]&nbsp;buffer,
        int&nbsp;offset,
        int&nbsp;length)</code>
<div class="block">Add a byte array to the current internal record.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#addEvent-java.nio.ByteBuffer-">addEvent</a></span>(java.nio.ByteBuffer&nbsp;buffer)</code>
<div class="block">Add a ByteBuffer to the internal record.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#addEvent-org.jlab.coda.jevio.EvioBank-">addEvent</a></span>(<a href="../../../../org/jlab/coda/jevio/EvioBank.html" title="class in org.jlab.coda.jevio">EvioBank</a>&nbsp;bank)</code>
<div class="block">Add an EvioBank to the internal record.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#addEvent-org.jlab.coda.jevio.EvioNode-">addEvent</a></span>(<a href="../../../../org/jlab/coda/jevio/EvioNode.html" title="class in org.jlab.coda.jevio">EvioNode</a>&nbsp;node)</code>
<div class="block">Add an EvioNode to the internal record.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#addTrailer--">addTrailer</a></span>()</code>
<div class="block">Does this writer add a trailer to the end of the file?</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#addTrailer-boolean-">addTrailer</a></span>(boolean&nbsp;addingTrailer)</code>
<div class="block">Set whether this writer adds a trailer to the end of the file.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#addTrailerWithIndex--">addTrailerWithIndex</a></span>()</code>
<div class="block">Does this writer add a trailer with a record index to the end of the file?</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#addTrailerWithIndex-boolean-">addTrailerWithIndex</a></span>(boolean&nbsp;addTrailingIndex)</code>
<div class="block">Set whether this writer adds a trailer with a record index to the end of the file.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#close--">close</a></span>()</code>
<div class="block">Close opened file.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>java.nio.ByteBuffer</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#createHeader-byte:A-">createHeader</a></span>(byte[]&nbsp;userHdr)</code>
<div class="block">Create and return a buffer containing a general file header
 followed by the user header given in the argument.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>java.nio.ByteOrder</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#getByteOrder--">getByteOrder</a></span>()</code>
<div class="block">Get the file's byte order.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code><a href="../../../../org/jlab/coda/hipo/FileHeader.html" title="class in org.jlab.coda.hipo">FileHeader</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#getFileHeader--">getFileHeader</a></span>()</code>
<div class="block">Get the file header.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#open-java.lang.String-">open</a></span>(java.lang.String&nbsp;filename)</code>
<div class="block">Open a new file and write file header with no user header.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#open-java.lang.String-byte:A-">open</a></span>(java.lang.String&nbsp;filename,
    byte[]&nbsp;userHdr)</code>
<div class="block">Open a file and write file header with given user's header.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#open-java.lang.String-byte:A-boolean-">open</a></span>(java.lang.String&nbsp;filename,
    byte[]&nbsp;userHdr,
    boolean&nbsp;overwrite)</code>
<div class="block">Open a file and write file header with given user's header.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code><a href="../../../../org/jlab/coda/hipo/WriterMT.html" title="class in org.jlab.coda.hipo">WriterMT</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#setCompressionType-org.jlab.coda.hipo.CompressionType-">setCompressionType</a></span>(<a href="../../../../org/jlab/coda/hipo/CompressionType.html" title="enum in org.jlab.coda.hipo">CompressionType</a>&nbsp;compression)</code>
<div class="block">Convenience method that sets compression type for the file.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/WriterMT.html#writeRecord-org.jlab.coda.hipo.RecordOutputStream-">writeRecord</a></span>(<a href="../../../../org/jlab/coda/hipo/RecordOutputStream.html" title="class in org.jlab.coda.hipo">RecordOutputStream</a>&nbsp;rec)</code>
<div class="block">Appends the record to the file.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="WriterMT--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>WriterMT</h4>
<pre>public&nbsp;WriterMT()</pre>
<div class="block">Default constructor is single-threaded, no compression. Little endian.
 <b>No</b> file is opened. Any file will have little endian byte order.
 1M max event count and 8M max buffer size.</div>
</li>
</ul>
<a name="WriterMT-java.nio.ByteOrder-int-int-org.jlab.coda.hipo.CompressionType-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>WriterMT</h4>
<pre>public&nbsp;WriterMT(java.nio.ByteOrder&nbsp;order,
                int&nbsp;maxEventCount,
                int&nbsp;maxBufferSize,
                <a href="../../../../org/jlab/coda/hipo/CompressionType.html" title="enum in org.jlab.coda.hipo">CompressionType</a>&nbsp;compressionType,
                int&nbsp;compressionThreads,
                int&nbsp;ringSize)
         throws java.lang.IllegalArgumentException</pre>
<div class="block">Constructor with byte order. <b>No</b> file is opened.
 Any dictionary will be placed in the user header which will create a conflict if
 user tries to call <a href="../../../../org/jlab/coda/hipo/WriterMT.html#open-java.lang.String-byte:A-"><code>open(String, byte[])</code></a> with another user header array.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>order</code> - byte order of written file</dd>
<dd><code>maxEventCount</code> - max number of events a record can hold.
                      Value &lt;= O means use default (1M).</dd>
<dd><code>maxBufferSize</code> - max number of uncompressed data bytes a record can hold.
                      Value of &lt; 8MB results in default of 8MB.</dd>
<dd><code>compressionType</code> - type of data compression to do (0=none, 1=lz4 fast, 2=lz4 best, 3=gzip)</dd>
<dd><code>compressionThreads</code> - number of threads doing compression simultaneously</dd>
<dd><code>ringSize</code> - number of records in supply ring, must be multiple of 2
                      and &gt;= compressionThreads.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if invalid compression type.</dd>
</dl>
</li>
</ul>
<a name="WriterMT-org.jlab.coda.hipo.HeaderType-java.nio.ByteOrder-int-int-java.lang.String-byte:A-int-org.jlab.coda.hipo.CompressionType-int-boolean-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>WriterMT</h4>
<pre>public&nbsp;WriterMT(<a href="../../../../org/jlab/coda/hipo/HeaderType.html" title="enum in org.jlab.coda.hipo">HeaderType</a>&nbsp;hType,
                java.nio.ByteOrder&nbsp;order,
                int&nbsp;maxEventCount,
                int&nbsp;maxBufferSize,
                java.lang.String&nbsp;dictionary,
                byte[]&nbsp;firstEvent,
                int&nbsp;firstEventLen,
                <a href="../../../../org/jlab/coda/hipo/CompressionType.html" title="enum in org.jlab.coda.hipo">CompressionType</a>&nbsp;compType,
                int&nbsp;compressionThreads,
                boolean&nbsp;addTrailerIndex,
                int&nbsp;ringSize)
         throws java.lang.IllegalArgumentException</pre>
<div class="block">Constructor with byte order.
 <b>No</b> file is opened.
 Any dictionary will be placed in the user header which will create a conflict if
 user tries to call <a href="../../../../org/jlab/coda/hipo/WriterMT.html#open-java.lang.String-byte:A-"><code>open(String, byte[])</code></a> with another user header array.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>hType</code> - the type of the file. If set to <a href="../../../../org/jlab/coda/hipo/HeaderType.html#HIPO_FILE"><code>HeaderType.HIPO_FILE</code></a>,
                      the header will be written with the first 4 bytes set to HIPO.</dd>
<dd><code>order</code> - byte order of written file</dd>
<dd><code>maxEventCount</code> - max number of events a record can hold.
                      Value &lt;= O means use default (1M).</dd>
<dd><code>maxBufferSize</code> - max number of uncompressed data bytes a record can hold.
                      Value of &lt; 8MB results in default of 8MB.</dd>
<dd><code>dictionary</code> - string holding an evio format dictionary to be placed in userHeader.</dd>
<dd><code>firstEvent</code> - byte array containing an evio event to be included in userHeader.
                      It must be in the same byte order as the order argument.</dd>
<dd><code>firstEventLen</code> - number of valid bytes in firstEvent.</dd>
<dd><code>compType</code> - type of data compression to do (one, lz4 fast, lz4 best, gzip)</dd>
<dd><code>compressionThreads</code> - number of threads doing compression simultaneously</dd>
<dd><code>addTrailerIndex</code> - if true, we add a record index to the trailer.</dd>
<dd><code>ringSize</code> - number of records in supply ring, must be multiple of 2
                      and &gt;= compressionThreads.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if invalid compression type.</dd>
</dl>
</li>
</ul>
<a name="WriterMT-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>WriterMT</h4>
<pre>public&nbsp;WriterMT(java.lang.String&nbsp;filename)
         throws <a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></pre>
<div class="block">Constructor with filename.
 The output file will be created with no user header.
 File byte order is little endian.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>filename</code> - output file name</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></code> - if filename arg is null or bad.</dd>
</dl>
</li>
</ul>
<a name="WriterMT-java.lang.String-java.nio.ByteOrder-int-int-org.jlab.coda.hipo.CompressionType-int-int-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>WriterMT</h4>
<pre>public&nbsp;WriterMT(java.lang.String&nbsp;filename,
                java.nio.ByteOrder&nbsp;order,
                int&nbsp;maxEventCount,
                int&nbsp;maxBufferSize,
                <a href="../../../../org/jlab/coda/hipo/CompressionType.html" title="enum in org.jlab.coda.hipo">CompressionType</a>&nbsp;compressionType,
                int&nbsp;compressionThreads,
                int&nbsp;ringSize)
         throws <a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></pre>
<div class="block">Constructor with filename and byte order.
 The output file will be created with no user header.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>filename</code> - output file name</dd>
<dd><code>order</code> - byte order of written file or null for default (little endian)</dd>
<dd><code>maxEventCount</code> - max number of events a record can hold.
                      Value of O means use default (1M).</dd>
<dd><code>maxBufferSize</code> - max number of uncompressed data bytes a record can hold.
                      Value of &lt; 8MB results in default of 8MB.</dd>
<dd><code>compressionType</code> - type of data compression to do (0=none, 1=lz4 fast, 2=lz4 best, 3=gzip)</dd>
<dd><code>compressionThreads</code> - number of threads doing compression simultaneously</dd>
<dd><code>ringSize</code> - number of records in supply ring, must be multiple of 2
                      and &gt;= compressionThreads.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></code> - if filename arg is null or bad.</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getByteOrder--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getByteOrder</h4>
<pre>public&nbsp;java.nio.ByteOrder&nbsp;getByteOrder()</pre>
<div class="block">Get the file's byte order.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>file's byte order.</dd>
</dl>
</li>
</ul>
<a name="getFileHeader--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFileHeader</h4>
<pre>public&nbsp;<a href="../../../../org/jlab/coda/hipo/FileHeader.html" title="class in org.jlab.coda.hipo">FileHeader</a>&nbsp;getFileHeader()</pre>
<div class="block">Get the file header.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>file header.</dd>
</dl>
</li>
</ul>
<a name="addTrailer--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addTrailer</h4>
<pre>public&nbsp;boolean&nbsp;addTrailer()</pre>
<div class="block">Does this writer add a trailer to the end of the file?</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if this writer adds a trailer to the end of the file, else false.</dd>
</dl>
</li>
</ul>
<a name="addTrailer-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addTrailer</h4>
<pre>public&nbsp;void&nbsp;addTrailer(boolean&nbsp;addingTrailer)</pre>
<div class="block">Set whether this writer adds a trailer to the end of the file.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>addingTrailer</code> - if true, at the end of file, add an ending header (trailer)
                      with no index of records and no following data.
                      Update the file header to contain a file offset to the trailer.</dd>
</dl>
</li>
</ul>
<a name="addTrailerWithIndex--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addTrailerWithIndex</h4>
<pre>public&nbsp;boolean&nbsp;addTrailerWithIndex()</pre>
<div class="block">Does this writer add a trailer with a record index to the end of the file?</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if this writer adds a trailer with a record index
         to the end of the file, else false.</dd>
</dl>
</li>
</ul>
<a name="addTrailerWithIndex-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addTrailerWithIndex</h4>
<pre>public&nbsp;void&nbsp;addTrailerWithIndex(boolean&nbsp;addTrailingIndex)</pre>
<div class="block">Set whether this writer adds a trailer with a record index to the end of the file.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>addTrailingIndex</code> - if true, at the end of file, add an ending header (trailer)
                         with an index of all records but with no following data.
                         Update the file header to contain a file offset to the trailer.</dd>
</dl>
</li>
</ul>
<a name="open-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>open</h4>
<pre>public final&nbsp;void&nbsp;open(java.lang.String&nbsp;filename)
                throws <a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></pre>
<div class="block">Open a new file and write file header with no user header.
 Existing file is NOT overwritten.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>filename</code> - output file name</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></code> - if filename arg is null or bad,
                       if this method already called without being
                       followed by reset.</dd>
</dl>
</li>
</ul>
<a name="open-java.lang.String-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>open</h4>
<pre>public final&nbsp;void&nbsp;open(java.lang.String&nbsp;filename,
                       byte[]&nbsp;userHdr)
                throws <a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></pre>
<div class="block">Open a file and write file header with given user's header.
 User header is automatically padded when written.
 Existing file is NOT overwritten.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>filename</code> - disk file name.</dd>
<dd><code>userHdr</code> - byte array representing the optional user's header.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></code> - if filename arg is null or bad,
                       if this method already called without being
                       followed by reset.</dd>
</dl>
</li>
</ul>
<a name="open-java.lang.String-byte:A-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>open</h4>
<pre>public final&nbsp;void&nbsp;open(java.lang.String&nbsp;filename,
                       byte[]&nbsp;userHdr,
                       boolean&nbsp;overwrite)
                throws <a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></pre>
<div class="block">Open a file and write file header with given user's header.
 User header is automatically padded when written.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>filename</code> - disk file name.</dd>
<dd><code>userHdr</code> - byte array representing the optional user's header.</dd>
<dd><code>overwrite</code> - if true, overwrite any existing file.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></code> - if filename arg is null or bad,
                       if this method already called without being followed by reset,
                       or if overwrite is false and file exists.</dd>
</dl>
</li>
</ul>
<a name="setCompressionType-org.jlab.coda.hipo.CompressionType-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setCompressionType</h4>
<pre>public final&nbsp;<a href="../../../../org/jlab/coda/hipo/WriterMT.html" title="class in org.jlab.coda.hipo">WriterMT</a>&nbsp;setCompressionType(<a href="../../../../org/jlab/coda/hipo/CompressionType.html" title="enum in org.jlab.coda.hipo">CompressionType</a>&nbsp;compression)</pre>
<div class="block">Convenience method that sets compression type for the file.
 The compression type is set for internal record.
 The record data will be compressed according to the given type.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>compression</code> - compression type</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>this object</dd>
</dl>
</li>
</ul>
<a name="createHeader-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createHeader</h4>
<pre>public&nbsp;java.nio.ByteBuffer&nbsp;createHeader(byte[]&nbsp;userHdr)</pre>
<div class="block">Create and return a buffer containing a general file header
 followed by the user header given in the argument.
 If user header is not padded to 4-byte boundary, it's done here.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>userHdr</code> - byte array containing a user-defined header, may be null.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>ByteBuffer containing a file header followed by the user-defined header</dd>
</dl>
</li>
</ul>
<a name="writeRecord-org.jlab.coda.hipo.RecordOutputStream-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeRecord</h4>
<pre>public&nbsp;void&nbsp;writeRecord(<a href="../../../../org/jlab/coda/hipo/RecordOutputStream.html" title="class in org.jlab.coda.hipo">RecordOutputStream</a>&nbsp;rec)
                 throws java.lang.IllegalArgumentException,
                        <a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></pre>
<div class="block">Appends the record to the file.
 Using this method in conjunction with <a href="../../../../org/jlab/coda/hipo/WriterMT.html#addEvent-byte:A-int-int-"><code>addEvent(byte[], int, int)</code></a>
 is not thread-safe.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>rec</code> - record object</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if arg's byte order is opposite to output endian.</dd>
<dd><code><a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></code> - if we cannot replace internal buffer of the current record
                       if it needs to be expanded since the buffer was provided
                       by the user.</dd>
</dl>
</li>
</ul>
<a name="addEvent-byte:A-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addEvent</h4>
<pre>public&nbsp;void&nbsp;addEvent(byte[]&nbsp;buffer,
                     int&nbsp;offset,
                     int&nbsp;length)
              throws <a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></pre>
<div class="block">Add a byte array to the current internal record. If the length of
 the buffer exceeds the maximum size of the record, the record
 will be written to the file (compressed if the flag is set).
 And another record will be obtained from the supply to receive the buffer.
 Using this method in conjunction with <a href="../../../../org/jlab/coda/hipo/WriterMT.html#writeRecord-org.jlab.coda.hipo.RecordOutputStream-"><code>writeRecord(RecordOutputStream)</code></a>
 is not thread-safe.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>buffer</code> - array to add to the file.</dd>
<dd><code>offset</code> - offset into array from which to start writing data.</dd>
<dd><code>length</code> - number of bytes to write from array.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></code> - if buffer arg is null.</dd>
</dl>
</li>
</ul>
<a name="addEvent-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addEvent</h4>
<pre>public&nbsp;void&nbsp;addEvent(byte[]&nbsp;buffer)
              throws <a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></pre>
<div class="block">Add a byte array to the current internal record. If the length of
 the buffer exceeds the maximum size of the record, the record
 will be written to the file (compressed if the flag is set).
 And another record will be obtained from the supply to receive the buffer.
 Using this method in conjunction with <a href="../../../../org/jlab/coda/hipo/WriterMT.html#writeRecord-org.jlab.coda.hipo.RecordOutputStream-"><code>writeRecord(RecordOutputStream)</code></a>
 is not thread-safe.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>buffer</code> - array to add to the file.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></code> - if buffer arg is null.</dd>
</dl>
</li>
</ul>
<a name="addEvent-java.nio.ByteBuffer-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addEvent</h4>
<pre>public&nbsp;void&nbsp;addEvent(java.nio.ByteBuffer&nbsp;buffer)
              throws <a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></pre>
<div class="block">Add a ByteBuffer to the internal record. If the length of
 the buffer exceeds the maximum size of the record, the record
 will be written to the file (compressed if the flag is set).
 And another record will be obtained from the supply to receive the buffer.
 Using this method in conjunction with writeRecord() is not thread-safe.
 <b>The byte order of event's data must
 match the byte order given in constructor!</b></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>buffer</code> - array to add to the file.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></code> - if buffer arg is null or byte order is wrong.</dd>
</dl>
</li>
</ul>
<a name="addEvent-org.jlab.coda.jevio.EvioBank-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addEvent</h4>
<pre>public&nbsp;void&nbsp;addEvent(<a href="../../../../org/jlab/coda/jevio/EvioBank.html" title="class in org.jlab.coda.jevio">EvioBank</a>&nbsp;bank)
              throws <a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></pre>
<div class="block">Add an EvioBank to the internal record. If the length of
 the bank exceeds the maximum size of the record, the record
 will be written to the file (compressed if the flag is set).
 Internal record will be reset to receive new buffers.
 Using this method in conjunction with writeRecord() is not thread-safe.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>bank</code> - event to add to the file.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></code> - if arg is null.</dd>
</dl>
</li>
</ul>
<a name="addEvent-org.jlab.coda.jevio.EvioNode-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addEvent</h4>
<pre>public&nbsp;void&nbsp;addEvent(<a href="../../../../org/jlab/coda/jevio/EvioNode.html" title="class in org.jlab.coda.jevio">EvioNode</a>&nbsp;node)
              throws <a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></pre>
<div class="block">Add an EvioNode to the internal record. If the length of
 the data exceeds the maximum size of the record, the record
 will be written to the file (compressed if the flag is set).
 Internal record will be reset to receive new buffers.
 Using this method in conjunction with writeRecord() is not thread-safe.
 <b>The byte order of node's data must
 match the byte order given in constructor!</b></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>node</code> - node to add to the file.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../org/jlab/coda/hipo/HipoException.html" title="class in org.jlab.coda.hipo">HipoException</a></code> - if node is null or does not correspond to a bank.</dd>
</dl>
</li>
</ul>
<a name="close--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>close</h4>
<pre>public&nbsp;void&nbsp;close()</pre>
<div class="block">Close opened file. If the output record contains events,
 they will be flushed to file. Trailer and its optional index
 written if requested.<p>
 <b>The addEvent or addRecord methods must no longer be called.</b></div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>close</code>&nbsp;in interface&nbsp;<code>java.lang.AutoCloseable</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/WriterMT.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/jlab/coda/hipo/Writer.html" title="class in org.jlab.coda.hipo"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/jlab/coda/hipo/WriterMT.html" target="_top">Frames</a></li>
<li><a href="WriterMT.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
