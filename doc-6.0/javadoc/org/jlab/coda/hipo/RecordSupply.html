<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- GitHub action javadoc-cleanup -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- End javadoc-cleanup block -->
<!-- Generated by javadoc (1.8.0_422) -->
<title>RecordSupply</title>
<meta name="date" content="2024-10-09">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="RecordSupply";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/RecordSupply.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../org/jlab/coda/hipo/Writer.html" title="class in org.jlab.coda.hipo"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/jlab/coda/hipo/RecordSupply.html" target="_top">Frames</a></li>
<li><a href="RecordSupply.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.jlab.coda.hipo</div>
<h2 title="Class RecordSupply" class="title">Class RecordSupply</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.jlab.coda.hipo.RecordSupply</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">RecordSupply</span>
extends java.lang.Object</pre>
<div class="block">This thread-safe, lock-free class is used to provide a very fast supply
 of RecordRingItems which are reused (using Disruptor software package).<p>

 It is a supply of RecordRingItems in which a single producer does a <a href="../../../../org/jlab/coda/hipo/RecordSupply.html#get--"><code>get()</code></a>,
 fills the record with data, and finally does a <a href="../../../../org/jlab/coda/hipo/RecordSupply.html#publish-org.jlab.coda.hipo.RecordRingItem-"><code>publish(RecordRingItem)</code></a>
 to let consumers know the data is ready.<p>

 This class is set up to handle 2 types of consumers.
 The first type is a thread which compresses a record's data.
 The number of such consumers is set in the constructor.
 Each of these will call <a href="../../../../org/jlab/coda/hipo/RecordSupply.html#getToCompress-int-"><code>getToCompress(int)</code></a> to get a record
 and eventually call <a href="../../../../org/jlab/coda/hipo/RecordSupply.html#releaseCompressor-org.jlab.coda.hipo.RecordRingItem-"><code>releaseCompressor(RecordRingItem)</code></a> to indicate it is
 finished compressing and the record is available for writing to disk.<p>

 The second type of consumer is a single thread which writes all compressed
 records to a file. This will call <a href="../../../../org/jlab/coda/hipo/RecordSupply.html#getToWrite--"><code>getToWrite()</code></a> to get a record
 and eventually call <a href="../../../../org/jlab/coda/hipo/RecordSupply.html#releaseWriter-org.jlab.coda.hipo.RecordRingItem-"><code>releaseWriter(RecordRingItem)</code></a> to indicate it is
 finished writing and the record is available for being filled with new data.<p>

 Due to the multithreaded nature of writing files using this class, a mechanism
 for reporting errors that occur in the writing and compressing threads is provided.
 Also, and probably more importantly, one can call errorAlert() to notify any
 compression or write threads that an error has occurred. That way these threads
 can clean up and exit.<p>

 It transparently makes sure that all records are written in the proper order.

 <pre><code>

   This is a graphical representation of how our ring buffer is set up.

   (1) The producer who calls get() will get a ring item allowing a record to be
       filled. That same user does a publish() when done with the record.

   (2) The consumer who calls getToCompress() will get that ring item and will
       compress its data. There may be any number of compression threads
       as long as <b># threads &lt;= # of ring items!!!</b>.
       That same user does a releaseCompressor() when done with the record.

   (3) The consumer who calls getToWrite() will get that ring item and will
       write its data to a file or another buffer. There may be only 1
       such thread. This same user does a releaseWriter() when done with the record.

                       ||
                       ||  writeBarrier
          ^            ||
         /            _____
    Write thread     /  |  \
              ---&gt;  /1 _|_ 2\  &lt;---- Compression Threads 1-M
  ================ |__/   \__|               |
                   |6 |   | 3|               V
             ^     |__|___|__| ==========================
             |      \ 5 | 4 /       compressBarrier
         Producer-&gt;  \__|__/


 </code></pre></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>6.0 9/21/17</dd>
<dt><span class="simpleTagLabel">Version:</span></dt>
<dd>6.0</dd>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>timmer</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#RecordSupply--">RecordSupply</a></span>()</code>
<div class="block">Constructor.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#RecordSupply-int-java.nio.ByteOrder-int-int-int-org.jlab.coda.hipo.CompressionType-">RecordSupply</a></span>(int&nbsp;ringSize,
            java.nio.ByteOrder&nbsp;order,
            int&nbsp;threadCount,
            int&nbsp;maxEventCount,
            int&nbsp;maxBufferSize,
            <a href="../../../../org/jlab/coda/hipo/CompressionType.html" title="enum in org.jlab.coda.hipo">CompressionType</a>&nbsp;compressionType)</code>
<div class="block">Constructor.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#errorAlert--">errorAlert</a></span>()</code>
<div class="block">Method to have sequence barriers throw a Disruptor's AlertException.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo">RecordRingItem</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#get--">get</a></span>()</code>
<div class="block">Get the next available record item from the ring buffer.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#getError--">getError</a></span>()</code>
<div class="block">If there is an error, this contains the error message.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#getFillLevel--">getFillLevel</a></span>()</code>
<div class="block">Get the percentage of data-filled but unwritten records in ring.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#getLastSequence--">getLastSequence</a></span>()</code>
<div class="block">Get the sequence of last ring buffer item published (seq starts at 0).</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#getMaxRingBytes--">getMaxRingBytes</a></span>()</code>
<div class="block">Get the max number of bytes the records in this supply can hold all together.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>java.nio.ByteOrder</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#getOrder--">getOrder</a></span>()</code>
<div class="block">Get the byte order of all records in this supply.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#getRingSize--">getRingSize</a></span>()</code>
<div class="block">Get the number of records in this supply.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code><a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo">RecordRingItem</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#getToCompress-int-">getToCompress</a></span>(int&nbsp;threadNumber)</code>
<div class="block">Get the next available record item from the ring buffer
 in order to compress the data already in it.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code><a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo">RecordRingItem</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#getToWrite--">getToWrite</a></span>()</code>
<div class="block">Get the next available record item from the ring buffer
 in order to write data into it.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#haveError--">haveError</a></span>()</code>
<div class="block">Has an error occurred in writing or compressing data?</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#haveError-boolean-">haveError</a></span>(boolean&nbsp;err)</code>
<div class="block">Set whether an error occurred in writing or compressing data.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#isDiskFull--">isDiskFull</a></span>()</code>
<div class="block">Has the writing of a RecordRingItem to disk has been stopped
 due to the disk partition being full?</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#publish-org.jlab.coda.hipo.RecordRingItem-">publish</a></span>(<a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo">RecordRingItem</a>&nbsp;item)</code>
<div class="block">Tell consumers that the record item is ready for consumption.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#release-int-long-">release</a></span>(int&nbsp;threadNum,
       long&nbsp;sequenceNum)</code>
<div class="block">Release claim on ring items up to sequenceNum for the given compressor thread.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#releaseCompressor-org.jlab.coda.hipo.RecordRingItem-">releaseCompressor</a></span>(<a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo">RecordRingItem</a>&nbsp;item)</code>
<div class="block">A compressing thread releases its claim on the given ring buffer item
 so it becomes available for use by writing thread behind the write barrier.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#releaseWriter-org.jlab.coda.hipo.RecordRingItem-">releaseWriter</a></span>(<a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo">RecordRingItem</a>&nbsp;item)</code>
<div class="block">A writer thread releases its claim on the given ring buffer item
 so it becomes available for reuse by the producer.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#releaseWriterSequential-org.jlab.coda.hipo.RecordRingItem-">releaseWriterSequential</a></span>(<a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo">RecordRingItem</a>&nbsp;item)</code>
<div class="block">A writer thread releases its claim on the given ring buffer item
 so it becomes available for reuse by the producer.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#setDiskFull-boolean-">setDiskFull</a></span>(boolean&nbsp;full)</code>
<div class="block">Set whether the writing of a RecordRingItem to disk has been stopped
 due to the disk partition being full.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jlab/coda/hipo/RecordSupply.html#setError-java.lang.String-">setError</a></span>(java.lang.String&nbsp;err)</code>
<div class="block">Set the error message.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="RecordSupply--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>RecordSupply</h4>
<pre>public&nbsp;RecordSupply()</pre>
<div class="block">Constructor. Ring size of 4 records, compression thread count of 1,
 LZ4 compression, little endian data.</div>
</li>
</ul>
<a name="RecordSupply-int-java.nio.ByteOrder-int-int-int-org.jlab.coda.hipo.CompressionType-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>RecordSupply</h4>
<pre>public&nbsp;RecordSupply(int&nbsp;ringSize,
                    java.nio.ByteOrder&nbsp;order,
                    int&nbsp;threadCount,
                    int&nbsp;maxEventCount,
                    int&nbsp;maxBufferSize,
                    <a href="../../../../org/jlab/coda/hipo/CompressionType.html" title="enum in org.jlab.coda.hipo">CompressionType</a>&nbsp;compressionType)
             throws java.lang.IllegalArgumentException</pre>
<div class="block">Constructor.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ringSize</code> - number of RecordRingItem objects in ring buffer.</dd>
<dd><code>order</code> - byte order of RecordOutputStream in each RecordRingItem object.</dd>
<dd><code>threadCount</code> - number of threads simultaneously doing compression.
                        Must be &lt;= ringSize.</dd>
<dd><code>maxEventCount</code> - max number of events each record can hold.
                        Value &lt;= O means use default (1M).</dd>
<dd><code>maxBufferSize</code> - max number of uncompressed data bytes each record can hold.
                        Value of &lt; 8MB results in default of 8MB.</dd>
<dd><code>compressionType</code> - type of data compression to do.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if args &lt; 1, ringSize not power of 2,
                                  threadCount &gt; ringSize.</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="errorAlert--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>errorAlert</h4>
<pre>public&nbsp;void&nbsp;errorAlert()</pre>
<div class="block">Method to have sequence barriers throw a Disruptor's AlertException.
 In this case, we can use it to warn write and compress threads which
 are waiting on barrier.waitFor() in <a href="../../../../org/jlab/coda/hipo/RecordSupply.html#getToCompress-int-"><code>getToCompress(int)</code></a> and
 <a href="../../../../org/jlab/coda/hipo/RecordSupply.html#getToWrite--"><code>getToWrite()</code></a>. Do this in case of a write, compress, or some other error.
 This allows any threads waiting on these 2 methods to wake up, clean up,
 and exit.</div>
</li>
</ul>
<a name="getMaxRingBytes--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMaxRingBytes</h4>
<pre>public&nbsp;int&nbsp;getMaxRingBytes()</pre>
<div class="block">Get the max number of bytes the records in this supply can hold all together.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>max number of bytes the records in this supply can hold all together.</dd>
</dl>
</li>
</ul>
<a name="getRingSize--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRingSize</h4>
<pre>public&nbsp;int&nbsp;getRingSize()</pre>
<div class="block">Get the number of records in this supply.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>number of records in this supply.</dd>
</dl>
</li>
</ul>
<a name="getOrder--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOrder</h4>
<pre>public&nbsp;java.nio.ByteOrder&nbsp;getOrder()</pre>
<div class="block">Get the byte order of all records in this supply.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>byte order of all records in this supply.</dd>
</dl>
</li>
</ul>
<a name="getFillLevel--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFillLevel</h4>
<pre>public&nbsp;long&nbsp;getFillLevel()</pre>
<div class="block">Get the percentage of data-filled but unwritten records in ring.
 Value of 0 means everything's been written. Value of 100 means
 that all records in the ring are filled with data (perhaps in
 various stages of being compressed) and have not been written yet.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>percentage of used records in ring.</dd>
</dl>
</li>
</ul>
<a name="getLastSequence--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLastSequence</h4>
<pre>public&nbsp;long&nbsp;getLastSequence()</pre>
<div class="block">Get the sequence of last ring buffer item published (seq starts at 0).</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>sequence of last ring buffer item published (seq starts at 0).</dd>
</dl>
</li>
</ul>
<a name="get--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>get</h4>
<pre>public&nbsp;<a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo">RecordRingItem</a>&nbsp;get()</pre>
<div class="block">Get the next available record item from the ring buffer.
 Use it to write data into the record.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>next available record item in ring buffer in order to write data into it.</dd>
</dl>
</li>
</ul>
<a name="publish-org.jlab.coda.hipo.RecordRingItem-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>publish</h4>
<pre>public&nbsp;void&nbsp;publish(<a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo">RecordRingItem</a>&nbsp;item)</pre>
<div class="block">Tell consumers that the record item is ready for consumption.
 To be used in conjunction with <a href="../../../../org/jlab/coda/hipo/RecordSupply.html#get--"><code>get()</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>item</code> - record item available for consumers' use.</dd>
</dl>
</li>
</ul>
<a name="getToCompress-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getToCompress</h4>
<pre>public&nbsp;<a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo">RecordRingItem</a>&nbsp;getToCompress(int&nbsp;threadNumber)
                             throws com.lmax.disruptor.AlertException,
                                    java.lang.InterruptedException</pre>
<div class="block">Get the next available record item from the ring buffer
 in order to compress the data already in it.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>threadNumber</code> - number of thread (0,1, ...) used to compress.
                     This number cannot exceed (compressionThreadCount - 1).</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>next available record item in ring buffer
         in order to compress data already in it.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>com.lmax.disruptor.AlertException</code> - if <a href="../../../../org/jlab/coda/hipo/RecordSupply.html#errorAlert--"><code>errorAlert()</code></a> called.</dd>
<dd><code>java.lang.InterruptedException</code> - if thread interrupted.</dd>
</dl>
</li>
</ul>
<a name="getToWrite--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getToWrite</h4>
<pre>public&nbsp;<a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo">RecordRingItem</a>&nbsp;getToWrite()
                          throws com.lmax.disruptor.AlertException,
                                 java.lang.InterruptedException</pre>
<div class="block">Get the next available record item from the ring buffer
 in order to write data into it.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>next available record item in ring buffer
         in order to write data into it.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>com.lmax.disruptor.AlertException</code> - if <a href="../../../../org/jlab/coda/hipo/RecordSupply.html#errorAlert--"><code>errorAlert()</code></a> called.</dd>
<dd><code>java.lang.InterruptedException</code> - if thread interrupted.</dd>
</dl>
</li>
</ul>
<a name="releaseCompressor-org.jlab.coda.hipo.RecordRingItem-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>releaseCompressor</h4>
<pre>public&nbsp;void&nbsp;releaseCompressor(<a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo">RecordRingItem</a>&nbsp;item)</pre>
<div class="block">A compressing thread releases its claim on the given ring buffer item
 so it becomes available for use by writing thread behind the write barrier.
 Because a compressing thread gets only every Nth record where
 N = compressionThreadCount, once it releases this record it also
 needs to release all events coming after, up until the one it will
 take next. In other words, also release the records it will skip over
 next. This allows close() to be called at any time without things
 hanging up.<p>

 To be used in conjunction with <a href="../../../../org/jlab/coda/hipo/RecordSupply.html#getToCompress-int-"><code>getToCompress(int)</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>item</code> - item in ring buffer to release for reuse.</dd>
</dl>
</li>
</ul>
<a name="releaseWriterSequential-org.jlab.coda.hipo.RecordRingItem-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>releaseWriterSequential</h4>
<pre>public&nbsp;boolean&nbsp;releaseWriterSequential(<a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo">RecordRingItem</a>&nbsp;item)</pre>
<div class="block">A writer thread releases its claim on the given ring buffer item
 so it becomes available for reuse by the producer.
 To be used in conjunction with <a href="../../../../org/jlab/coda/hipo/RecordSupply.html#getToWrite--"><code>getToWrite()</code></a>.<p>

 Care must be taken to ensure thread-safety.
 This method may only be called if the writing is done IN THE SAME THREAD
 as the calling of this method so that items are released in sequence
 as ensured by the caller.
 Otherwise use <a href="../../../../org/jlab/coda/hipo/RecordSupply.html#releaseWriter-org.jlab.coda.hipo.RecordRingItem-"><code>releaseWriter(RecordRingItem)</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>item</code> - item in ring buffer to release for reuse.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>false if item not released since item is null, else true.</dd>
</dl>
</li>
</ul>
<a name="releaseWriter-org.jlab.coda.hipo.RecordRingItem-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>releaseWriter</h4>
<pre>public&nbsp;boolean&nbsp;releaseWriter(<a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo">RecordRingItem</a>&nbsp;item)</pre>
<div class="block">A writer thread releases its claim on the given ring buffer item
 so it becomes available for reuse by the producer.
 To be used in conjunction with <a href="../../../../org/jlab/coda/hipo/RecordSupply.html#getToWrite--"><code>getToWrite()</code></a>.<p>

 Care must be taken to ensure thread-safety.
 The following can happen if no precautions are taken.
 In the case of EventWriterUnsync, writing to a file involves 2, simultaneous,
 asynchronous writes to a file - both in separate threads to the thread which
 calls the "write" method. If the writing of the later item finishes first, it
 releases it's item and sequence which, unfortunately, also releases the
 previous item's sequence (which is still being written). When the first write is complete,
 it also releases its item. However item.getSequenceObj() will return null
 (causing NullPointerException) because it was already released thereby allowing
 it to be reused and reset called on it.<p>

 In order to prevent such a scenario, releaseWriter ensures that items are only
 released in sequence.<p>

 If the same item is released more than once, bad things will happen.
 Thus the caller must take steps to prevent it. To avoid problems,
 call <a href="../../../../org/jlab/coda/hipo/RecordRingItem.html#setAlreadyReleased-boolean-"><code>RecordRingItem.setAlreadyReleased(boolean)</code></a> and set to true if
 item is released but will still be used in some manner.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>item</code> - item in ring buffer to release for reuse.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>false if item not released since item is null, else true.</dd>
</dl>
</li>
</ul>
<a name="release-int-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>release</h4>
<pre>public&nbsp;void&nbsp;release(int&nbsp;threadNum,
                    long&nbsp;sequenceNum)</pre>
<div class="block">Release claim on ring items up to sequenceNum for the given compressor thread.
 For internal use only - to free up records that the compressor thread will skip
 over anyway.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>threadNum</code> - compressor thread number</dd>
<dd><code>sequenceNum</code> - sequence to release</dd>
</dl>
</li>
</ul>
<a name="haveError--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>haveError</h4>
<pre>public&nbsp;boolean&nbsp;haveError()</pre>
<div class="block">Has an error occurred in writing or compressing data?</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if an error occurred in writing or compressing data.</dd>
</dl>
</li>
</ul>
<a name="haveError-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>haveError</h4>
<pre>public&nbsp;void&nbsp;haveError(boolean&nbsp;err)</pre>
<div class="block">Set whether an error occurred in writing or compressing data.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>err</code> - <code>true</code> if an error occurred in writing or compressing data.</dd>
</dl>
</li>
</ul>
<a name="getError--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getError</h4>
<pre>public&nbsp;java.lang.String&nbsp;getError()</pre>
<div class="block">If there is an error, this contains the error message.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>error message if there is an error.</dd>
</dl>
</li>
</ul>
<a name="setError-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setError</h4>
<pre>public&nbsp;void&nbsp;setError(java.lang.String&nbsp;err)</pre>
<div class="block">Set the error message.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>err</code> - error message.</dd>
</dl>
</li>
</ul>
<a name="isDiskFull--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isDiskFull</h4>
<pre>public&nbsp;boolean&nbsp;isDiskFull()</pre>
<div class="block">Has the writing of a RecordRingItem to disk has been stopped
 due to the disk partition being full?</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if he writing of a RecordRingItem to disk has been stopped
          due to the disk partition being full.</dd>
</dl>
</li>
</ul>
<a name="setDiskFull-boolean-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>setDiskFull</h4>
<pre>public&nbsp;void&nbsp;setDiskFull(boolean&nbsp;full)</pre>
<div class="block">Set whether the writing of a RecordRingItem to disk has been stopped
 due to the disk partition being full.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>full</code> - true if he writing of a RecordRingItem to disk has been stopped
             due to the disk partition being full.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/RecordSupply.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/jlab/coda/hipo/RecordRingItem.html" title="class in org.jlab.coda.hipo"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../org/jlab/coda/hipo/Writer.html" title="class in org.jlab.coda.hipo"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/jlab/coda/hipo/RecordSupply.html" target="_top">Frames</a></li>
<li><a href="RecordSupply.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
